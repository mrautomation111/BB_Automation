*** Settings ***
Resource          ../Libraries/librarymanager.txt
Resource          Commonkeywords.txt
Library           DateTime
Library           ExcelLibrary
Library           ../scripts/excellib.py

*** Variables ***
${url}            https://bbsitedemo.btbanking.com/onlineserv/CM/?D=5472
${browser}        gc

*** Keywords ***
Openbb_app
    Open Browser    ${url}    ${browser}
    Maximize Browser Window
    web_clickelement    landingpage    loginlink

CreateReports
    web_clickelement    landingpage    Account activities and reporting
    web_clickelement    Account activities and reporting    Create reports
    Open Excel Document    ${CreateReports}    CreateReports
    @{List_Accounts}    ExcelLibrary.Read Excel Column    1
    FOR    ${i}    IN    @{List_Accounts}
        Select Checkbox    //*[contains(text(),'${i}')]/ancestor::tr//input
    END
    @{List_Category}    ExcelLibrary.Read Excel Column    2
    FOR    ${j}    IN    @{List_Category}
        Select Checkbox    //td[text()='${j}']/ancestor::tr//input
    END
    ${date}    Get Current Date    result_format=datetime
    web_inputtext    Create reports    Report Name    AllDebitsReportName
    web_inputtext    Create reports    Report Title    AllDebitsReportTitle_${date.year}${date.month}${date.day}${date.hour}${date.minute}
    web_clickelement    Create reports    Add Report
    web_clickelement    Create reports    Delete Report
    web_clickelement    Create reports    Delete_Message_Window
    web_clickelement    landingpage    Log Out
    Close All Excel Documents
    Close Browser
