*** Settings ***
Resource          ../Libraries/librarymanager.txt
Resource          Commonkeywords.txt

*** Variables ***
${url}            https://bbsitedemo.btbanking.com/onlineserv/CM/?D=5472
${browser}        gc
${EmailFile}      ${EXECDIR}//Testdata//EmailData.xlsx

*** Keywords ***
Openbb_app
    Open Browser    ${url}    ${browser}
    web_clickelement    landingpage    loginlink

Send_Email
    [Arguments]    ${EmailNo}
    web_clickelement    landingpage    EmailLink
    web_clickelement    Emailpage    Preferred_Method_of_Contact
    GetEmailDetails    ${EmailNo}
    web_inputtext    Emailpage    Subject    ${subject_name}
    web_inputtext    Emailpage    Message    ${email_description}
    web_clickelement    Emailpage    Submit

GetEmailDetails
    [Arguments]    ${EmailNo}
    Log Many    ${EmailFile}    ${EmailNo}
    excellib.Openexcel    ${EmailFile}    Sheet1
    ${val}    excellib.filterbasedonalphabet    ${EmailNo}
    ${result}    excellib.Converttolist
    Set Test Variable    ${subject_name}    ${result}[0][2]
    Set Test Variable    ${email_description}    ${result}[0][3]
    log    ${val}
